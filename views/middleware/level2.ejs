<%- include('../layout', { body: `
<div class="challenge">
  <div class="challenge-description">
    <h3>中间件漏洞 - Level 2 (Cookie解析漏洞)</h3>
    <p>这个挑战演示了Cookie解析漏洞。</p>
    <p>尝试注入特制的Cookie字符串来篡改应用程序状态。</p>
  </div>

  <div class="challenge-form">
    <form method="POST" action="/middleware/level2">
      <div class="form-group">
        <label for="cookie">Cookie字符串:</label>
        <input type="text" id="cookie" name="cookie" class="form-control" value="${cookie}">
      </div>
      <div class="form-text text-muted">输入一个Cookie字符串，如: name=value; user=john</div>
      <button type="submit" class="btn btn-primary mt-2">解析Cookie</button>
      <a href="/source/middleware/2" class="btn">查看源码</a>
    </form>
  </div>

  ${result ? `
  <div class="challenge-result">
    <h4>解析结果:</h4>
    <pre>${result}</pre>
  </div>
  ` : ''}

  <div class="challenge-hint">
    <h4>提示:</h4>
    <p>Cookie解析中的对象注入漏洞可以允许攻击者篡改应用程序状态。</p>
    <p>尝试使用特殊字符或结构化的值来注入对象。</p>
    <p>例如可以尝试:</p>
    <pre>user=normal; isAdmin={"valueOf":true}</pre>
    <p>或者:</p>
    <pre>user=normal; isAdmin={"toString":true}</pre>
  </div>
</div>
` }) %> 