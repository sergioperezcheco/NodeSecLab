<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> - Web安全靶场</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <div class="container">
    <div class="sidebar">
      <div class="logo">
        <h1>Web安全靶场</h1>
      </div>
      <nav class="menu">
        <ul>
          <li class="<%= activeMenu === 'home' ? 'active' : '' %>">
            <a href="/">首页</a>
          </li>
          
          <li class="<%= activeMenu === 'sqli' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">SQL注入</a>
            <ul class="dropdown-menu <%= activeMenu === 'sqli' ? 'show' : '' %>">
              <li><a href="/sqli/level1">Level 1</a></li>
              <li><a href="/sqli/level2">Level 2</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'xss' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">XSS</a>
            <ul class="dropdown-menu <%= activeMenu === 'xss' ? 'show' : '' %>">
              <li><a href="/xss/level1">Level 1 (反射型XSS)</a></li>
              <li><a href="/xss/level2">Level 2 (存储型XSS)</a></li>
              <li><a href="/xss/level3">Level 3 (URL参数XSS)</a></li>
              <li><a href="/xss/level4">Level 4 (输入框属性XSS)</a></li>
              <li><a href="/xss/level5">Level 5 (过滤绕过XSS)</a></li>
              <li><a href="/xss/level6">Level 6 (Style标签XSS)</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'csrf' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">CSRF</a>
            <ul class="dropdown-menu <%= activeMenu === 'csrf' ? 'show' : '' %>">
              <li><a href="/csrf/level1">Level 1 (POST型)</a></li>
              <li><a href="/csrf/level2">Level 2 (Token型)</a></li>
              <li><a href="/csrf/level3">Level 3 (GET型)</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'upload' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">文件上传</a>
            <ul class="dropdown-menu <%= activeMenu === 'upload' ? 'show' : '' %>">
              <li><a href="/upload/level1">Level 1</a></li>
              <li><a href="/upload/level2">Level 2</a></li>
              <li><a href="/upload/level3">Level 3 (前端JS验证)</a></li>
              <li><a href="/upload/level4">Level 4 (大小写后缀)</a></li>
              <li><a href="/upload/level5">Level 5 (双写后缀)</a></li>
              <li><a href="/upload/level6">Level 6 (Content-Type)</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'download' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">文件下载</a>
            <ul class="dropdown-menu <%= activeMenu === 'download' ? 'show' : '' %>">
              <li><a href="/download/level1">Level 1</a></li>
              <li><a href="/download/level2">Level 2</a></li>
            </ul>
          </li>

          <!-- 新增漏洞类型菜单 -->
          <li class="<%= activeMenu === 'command' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">命令执行</a>
            <ul class="dropdown-menu <%= activeMenu === 'command' ? 'show' : '' %>">
              <li><a href="/command/level1">Level 1</a></li>
              <li><a href="/command/level2">Level 2</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'include' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">文件包含</a>
            <ul class="dropdown-menu <%= activeMenu === 'include' ? 'show' : '' %>">
              <li><a href="/include/level1">Level 1</a></li>
              <li><a href="/include/level2">Level 2</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'xml' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">XML注入</a>
            <ul class="dropdown-menu <%= activeMenu === 'xml' ? 'show' : '' %>">
              <li><a href="/xml/level1">Level 1</a></li>
              <li><a href="/xml/level2">Level 2</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'logic' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">业务逻辑漏洞</a>
            <ul class="dropdown-menu <%= activeMenu === 'logic' ? 'show' : '' %>">
              <li><a href="/logic/level1">Level 1 (越权)</a></li>
              <li><a href="/logic/level2">Level 2 (重放)</a></li>
            </ul>
          </li>
          
          <li class="<%= activeMenu === 'middleware' ? 'active' : '' %>">
            <a href="#" class="dropdown-toggle">中间件漏洞</a>
            <ul class="dropdown-menu <%= activeMenu === 'middleware' ? 'show' : '' %>">
              <li><a href="/middleware/level1">Level 1</a></li>
              <li><a href="/middleware/level2">Level 2</a></li>
            </ul>
          </li>
        </ul>
      </nav>
    </div>
    
    <div class="content">
      <div class="header">
        <h2><%= title %></h2>
      </div>
      <div class="main">
        <%- body %>
      </div>
      <div class="footer">
        <!-- <p>Web安全靶场 &copy; <%= new Date().getFullYear() %></p> -->
        <p>Web安全靶场 &copy; checo</p>
      </div>
    </div>
  </div>

  <script src="/js/main.js"></script>
</body>
</html> 